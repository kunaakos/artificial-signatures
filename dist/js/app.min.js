var template=null,currentDivision=null,domainNames={boutique:"www.artificialgroup.com",craft:"www.artificialgroup.com",event:"www.artificialevent.com",digital:"www.artificialdigital.com"},divisionNames={boutique:"Boutique Creative",craft:"Craft Division",event:"Event Division",digital:"Digital Division"},divisionColors={boutique:"#149c86",craft:"#d17f24",event:"#3a7fb6",digital:"#da5340"},setTemplate=function(templateName){var source=$("#template").html();return Handlebars.compile(source)},getDomainName=function(divisionName){return domainNames[divisionName]?domainNames[divisionName]:null},getDivisionName=function(divisionName){return divisionNames[divisionName]?divisionNames[divisionName]:null},getDivisionColor=function(divisionName){return divisionColors[divisionName]?divisionColors[divisionName]:null};setDivision=function(divisionName){$("#email-postfix").html(getDomainName(divisionName)),currentDivision=divisionName},updateForm=function(){var pData=processFormData(getFormData());renderTemplate(pData)},getFormData=function(){for(var formData={},myForm=document.getElementById("employee-data"),i=0;i<myForm.elements.length;i++)formData[myForm.elements[i].name]=myForm.elements[i].value;return formData},renderTemplate=function(pData){setDivision(pData.division),template=setTemplate(pData.division);var html=template(pData.context);window.requestAnimationFrame(function(){$("#target").html(html)})},processFormData=function(formData){var ctxt={};return ctxt.name=formData.name,ctxt.position=formData.position,ctxt.siteUrl=getDomainName(formData.division),ctxt.divisionName=getDivisionName(formData.division),ctxt.divisionID=formData.division,ctxt.divisionColor=getDivisionColor(formData.division),ctxt.phone=formData.phone?"+36 "+formData.phone:null,{context:ctxt,division:formData.division}},downloadSignatureHtml=function(filename,elId,mimeType){var elHtml=$(elId).html(),link=document.createElement("a");mimeType=mimeType||"text/plain",link.setAttribute("download",filename),link.setAttribute("href","data:"+mimeType+";charset=utf-8,"+encodeURIComponent(elHtml)),link.click()},$(document).foundation(),updateForm(),$("input").on("keyup",function(){updateForm()}),$("#btn-save").on("click",function(){downloadSignatureHtml("signature.html","#target","text/html")}),$("#division-select").on("change",function(){setDivision(this.value),updateForm()});